# 弹出页面 (Popup Page) 布局设计

本文档详细描述了“Chrome 浏览器文章翻译插件”弹出页面的布局设计和交互流程。设计遵循“简约、现代、高效”的原则，旨在为用户提供最直观、最流畅的操作体验。

## 1. 核心设计理念

弹出页面是用户与插件交互的核心入口。我们将其设计为一个多状态的单页应用，通过状态变化来响应用户的操作和数据显示，避免页面跳转带来的干扰。

- **单一入口**: 用户所有操作均在当前页面完成。
- **状态驱动**: 界面根据“初始状态”、“处理中状态”和“结果展示状态”动态变化。
- **即时反馈**: 通过动画、加载指示和动态效果，让用户时刻了解当前进度。

## 2. 页面布局 ASCII 示意图

为了直观地展示页面布局，我们使用 ASCII 字符画来模拟不同状态下的界面。

### 2.1. 初始状态 (Initial State)

当用户首次点击插件图标，或上一次翻译结果为空时，将展示此界面。

**布局示意图:**

```
+------------------------------------------+
|                                          |
|      🌐 文章一键翻译                     |
|                                          |
| +--------------------------------------+ |
| |                                      | |
| |        [插画：一个正在阅读的机器人]      | |
| |                                      | |
| +--------------------------------------+ |
|                                          |
|   [ 🚀 立即翻译 ]                        |
|                                          |
|   [ 设置 ⚙️ ]                            |
|                                          |
+------------------------------------------+
```

**模块说明:**

| 模块 | 描述 | 核心职责 |
| :--- | :--- | :--- |
| **标题** | `文章一键翻译` | 清晰传达插件的核心功能。 |
| **插画区域** | `[插画]` | 放置一个简洁、有趣的品牌插画，提升视觉吸引力。 |
| **主操作按钮** | `[🚀 立即翻译]` | 用户最主要的操作入口，点击后立即开始提取和翻译流程。 |
| **次要操作** | `[设置 ⚙️]` | 提供一个入口，用于未来可能的设置项，如 API Key 配置、模型选择等。初期可隐藏或禁用。 |

### 2.2. 处理中状态 (Processing State)

当用户点击“立即翻译”后，页面进入此状态，向用户提供清晰的进度反馈。

**布局示意图:**

```
+------------------------------------------+
|                                          |
|      🌐 正在为您生成摘要...              |
|                                          |
| +--------------------------------------+ |
| |                                      | |
| |      [流畅的加载动画，如波浪线]        | |
| |                                      | |
| +--------------------------------------+ |
|                                          |
|   [ 正在提取内容... (1/3) ]              |
|                                          |
|   [ 取消 ]                               |
|                                          |
+------------------------------------------+
```

**模块说明:**

| 模块 | 描述 | 核心职责 |
| :--- | :--- | :--- |
| **动态标题** | `正在为您生成摘要...` | 实时更新当前任务状态，让用户有耐心等待。 |
| **加载动画** | `[加载动画]` | 使用流畅、不卡顿的动画效果（如 CSS 动画），缓解等待焦虑。 |
| **进度指示器** | `[正在提取内容... (1/3)]` | 分步展示当前进度：<br>1. 提取内容 (1/3)<br>2. 转换为 Markdown (2/3)<br>3. 调用 AI 翻译 (3/3) |
| **取消按钮** | `[取消]` | 允许用户随时中断当前操作。 |

### 2.3. 结果展示状态 (Result State)

翻译完成后，页面切换到此状态，展示最终结果，并提供后续操作。

**布局示意图:**

```
+------------------------------------------+
| [返回] [🔄 重新生成] [📥 下载 .md] [📋 复制] |
+------------------------------------------+
|                                          |
| # [文章标题]                             |
|                                          |
| > **作者**: [作者名]                     |
| > **原文链接**: [原始文章URL]            |
|                                          |
| [翻译后的正文，以打字机效果逐字出现]     |
| ...                                      |
| ...                                      |
|                                          |
+------------------------------------------+
```

**模块说明:**

| 模块 | 描述 | 核心职责 |
| :--- | :--- | :--- |
| **顶部操作栏** | `[返回] [重新生成] [下载] [复制]` | 提供一组快捷操作：<br>- **返回**: 回到初始状态。<br>- **重新生成**: 使用相同原文再次调用翻译。<br>- **下载 .md**: 将结果保存为 Markdown 文件。<br>- **复制**: 将结果复制到剪贴板。 |
| **结果展示区** | `[文章标题]` `[作者]` `[原文链接]` `[正文]` | 严格按照 `requirement.md` 中定义的格式展示内容。<br>- **打字机效果**: 正文部分使用打字机动画，逐字或逐词显示，模拟 AI 思考过程，提升趣味性。 |

## 3. 实现步骤规划

根据以上设计，前端的实现步骤可以规划如下：

1.  **搭建基础 HTML/CSS 结构**:
    *   创建 `popup.html`，包含所有状态可能用到的 DOM 元素。
    *   使用 CSS `class` 来控制不同状态的显示与隐藏（例如，`.initial-state`, `.processing-state`, `.result-state`）。

2.  **实现状态切换逻辑 (JavaScript/TypeScript)**:
    *   在 `popup/script.ts` 中，定义一个状态管理器，用于切换页面 `body` 或根容器的 `class`。
    *   为主操作按钮绑定点击事件，触发状态从“初始”到“处理中”的切换。

3.  **实现处理中状态的动画与进度**:
    *   使用 CSS 创建流畅的加载动画。
    *   在与 `background.js` 的通信中，接收进度消息，并更新界面上的进度指示文本。

4.  **实现结果展示与打字机效果**:
    *   从 `background.js` 接收到翻译文本流。
    *   实现一个 `typewriter` 函数，将文本流动态地、逐字地渲染到结果展示区。
    *   将文章元数据（标题、作者、链接）填充到相应位置。

5.  **实现顶部操作栏功能**:
    *   为“下载”、“复制”、“重新生成”等按钮绑定事件，并实现相应的功能。

通过以上规划，我们可以确保开发过程清晰、有序，最终交付一个符合设计预期的、高质量的 Chrome 插件。
